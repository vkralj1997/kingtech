// i18n dictionary (DE & EN only)
const I18N = {
  de: {
    nav_home: "Start",
    nav_services: "Leistungen",
    nav_pricing: "Preise",
    nav_about: "Über uns",
    nav_contact: "Kontakt",
    nav_order: "Bestellen",
    kicker: "Schnell • Preiswert • Mehrsprachig (DE/EN)",
    hero_h1: "IT-Hilfe leicht gemacht",
    hero_p: "PC-Probleme, Datenrettung, AI-Dokumente & Grafiken – klar erklärt, fair bepreist, remote oder nach Absprache vor Ort.",
    btn_see_services: "Leistungen ansehen",
    btn_order: "Jetzt bestellen",

    services_h2: "Leistungen",
    services_cap: "Transparente Preise · Weltweit remote · Vor Ort in Rottal-Inn nach Absprache.",

    service_it_title: "Mikro-IT-Support",
    service_it_desc: "Outlook/Teams/OneDrive, Drucker & Treiber, Windows-Bereinigung, kleine Fehlerbehebungen u. v. m.",
    service_it_price: "ab 20 € / Problem · Paket 50 €",

    service_recovery_title: "Datenrettung & Backup",
    service_recovery_desc: "Wiederherstellung gelöschter Dateien und Einrichtung automatischer Backups, damit es nicht wieder passiert.",
    service_recovery_price: "30–100 € je nach Umfang · +20 € Backup-Einrichtung",

    service_pcfix_title: "PC-Reparatur & Upgrades",
    service_pcfix_desc: "SSD/RAM-Tausch, Reinigung, Windows-Neuinstallation/Aktivierung, WLAN-Optimierung, Virenentfernung, Datenumzug, Performance-Check.",
    service_pcfix_price: "ab 30 € (zzgl. Teile)",

    service_pcbuild_title: "Custom PC nach Wunsch",
    service_pcbuild_desc: "Spezifikationen nach Bedarf (Gaming, Office, Creator), Teileliste, Aufbau, Windows-Setup.",
    service_pcbuild_price: "Beratung ab 50 € · Aufbau nach Angebot",

    service_ai_title: "AI-Erstellungen (Dokumente & Grafiken)",
    service_ai_desc: "Moderner Lebenslauf, LinkedIn-Refresh, Banner, Produktbilder oder Social-Post-Pakete.",
    service_ai_price: "20–50 € pro Ergebnis",

    service_tutor_title: "Tech-Schulung (bald)",
    service_tutor_desc: "Geduldige 1:1-Sessions für Setup & Online-Sicherheit. Start wird separat angekündigt.",
    service_tutor_price: "20–40 €/Std (TBD)",

    pricing_h2: "Preise",
    pricing_quick_title: "Quick Fix",
    pricing_quick_desc: "1 Problem, Remote-Sitzung (15–30 min).",
    pricing_quick_price: "20 €",
    pricing_bundle_title: "Support-Paket",
    pricing_bundle_desc: "Bis zu 3 Probleme in einer Sitzung.",
    pricing_bundle_price: "50 €",
    pricing_recovery_title: "Datenrettung",
    pricing_recovery_desc: "Basis-Recovery (USB/HDD/SD). „Kein Erfolg – keine Gebühr“ optional.",
    pricing_recovery_price: "30–100 €",
    pricing_ai_title: "AI-Erstellungen",
    pricing_ai_desc: "CV, Banner, Produktfoto oder 10-Post-Paket.",
    pricing_ai_price: "20–50 €",

    about_h2: "Über KingTech",
    about_do_title: "Was wir tun",
    about_do_desc: "Praktische, schnelle Hilfe für Alltags-IT. Klare Kommunikation, Festpreise, Remote-First.",
    about_why_title: "Warum wir",
    about_why_desc: "Microsoft-365-Admin-Know-how, Windows-Erfahrung und viel Troubleshooting aus der Praxis. DE/EN.",
    about_area_title: "Gebiet",
    about_area_desc: "Remote weltweit; vor Ort nach Absprache im Raum Eggenfelden/Rottal-Inn.",

    order_h2: "Bestellen",
    order_cap: "Sende eine Web-Bestellung per E-Mail – wir antworten in der Regel am selben Tag.",
    order_web_title: "Web-Bestellung (E-Mail)",
    order_web_desc: "Dieses Formular öffnet dein E-Mail-Programm und adressiert die Anfrage an <strong>kingtech@gmail.com</strong>.",
    form_name: "Dein Name",
    form_email: "E-Mail",
    form_service: "Leistung",
    form_message: "Beschreibe dein Anliegen",
    form_send: "Senden",

    contact_h2: "Kontakt",
    direct: "Direkt",
    location: "Standort: Eggenfelden, DE · Remote weltweit",
    faq: "FAQ",
    q_nofee: "Kein Erfolg – keine Gebühr?",
    a_nofee: "Bei Datenrettung möglich. Beim IT-Support zahlst du nur, wenn das Problem gelöst ist oder du zufrieden bist.",
    q_onsite: "Vor-Ort-Termine?",
    a_onsite: "Im Landkreis Rottal-Inn nach Absprache. Anfahrtspauschale möglich.",
    q_pay: "Zahlungsarten?",
    a_pay: "Bar oder PayPal. Rechnung bei Barzahlung über Zervant. Weitere Optionen folgen.",

    privacy_h2: "Datenschutzerklärung (Kurzfassung)",
    privacy_p1: "Wir verarbeiten personenbezogene Daten (z. B. Name, E-Mail) ausschließlich zur Beantwortung von Anfragen und Bestellungen (Art. 6 Abs. 1 lit. b und f DSGVO).",
    privacy_p2: "Bei Nutzung von WhatsApp gelten deren Datenschutzbestimmungen. Daten können in Drittländer übertragen werden.",
    privacy_p3: "Rechte: Auskunft, Berichtigung, Löschung, Einschränkung. Kontakt: kingtech@gmail.com",
    privacy_link: "Datenschutz",
  },
  en: {
    nav_home: "Home",
    nav_services: "Services",
    nav_pricing: "Pricing",
    nav_about: "About",
    nav_contact: "Contact",
    nav_order: "Order",
    kicker: "Fast • Affordable • Multilingual (DE/EN)",
    hero_h1: "IT help made easy",
    hero_p: "PC issues, data recovery, AI documents & graphics — clearly explained and fairly priced, remote or on-site by arrangement.",
    btn_see_services: "See services",
    btn_order: "Order now",

    services_h2: "Services",
    services_cap: "Transparent prices · Remote worldwide · On-site in Rottal-Inn on request.",

    service_it_title: "Micro IT Support",
    service_it_desc: "Outlook/Teams/OneDrive, printers & drivers, Windows cleanup, small fixes and more.",
    service_it_price: "from €20 / issue · bundle €50",

    service_recovery_title: "Data Recovery & Backup",
    service_recovery_desc: "Restore deleted files and set up automatic backups so it doesn’t happen again.",
    service_recovery_price: "€30–100 depending on scope · +€20 backup setup",

    service_pcfix_title: "PC Repair & Upgrades",
    service_pcfix_desc: "SSD/RAM swap, cleaning, Windows reinstall/activation, Wi‑Fi optimization, virus removal, data migration, performance check.",
    service_pcfix_price: "from €30 (plus parts)",

    service_pcbuild_title: "Custom PC (to order)",
    service_pcbuild_desc: "Specs for gaming/office/creator, parts list, build, Windows setup.",
    service_pcbuild_price: "Consulting from €50 · build by quote",

    service_ai_title: "AI Creations (Docs & Graphics)",
    service_ai_desc: "Modern CV, LinkedIn refresh, banners, product photos or social post packs.",
    service_ai_price: "€20–50 per result",

    service_tutor_title: "Tech tutoring (soon)",
    service_tutor_desc: "Patient 1:1 sessions for setup & online safety. Launch will be announced.",
    service_tutor_price: "€20–40/hr (TBD)",

    pricing_h2: "Pricing",
    pricing_quick_title: "Quick Fix",
    pricing_quick_desc: "1 issue, remote session (15–30 min).",
    pricing_quick_price: "€20",
    pricing_bundle_title: "Support Bundle",
    pricing_bundle_desc: "Up to 3 issues in one session.",
    pricing_bundle_price: "€50",
    pricing_recovery_title: "Data Recovery",
    pricing_recovery_desc: "Basic recovery (USB/HDD/SD). Optional “no fix — no fee”.",
    pricing_recovery_price: "€30–100",
    pricing_ai_title: "AI Creations",
    pricing_ai_desc: "CV, banner, product photo or 10-post pack.",
    pricing_ai_price: "€20–50",

    about_h2: "About KingTech",
    about_do_title: "What we do",
    about_do_desc: "Practical, fast everyday IT help. Clear communication, flat prices, remote-first.",
    about_why_title: "Why us",
    about_why_desc: "Microsoft 365 admin skills, Windows experience and lots of real-world troubleshooting. DE/EN.",
    about_area_title: "Area",
    about_area_desc: "Remote worldwide; on-site around Eggenfelden/Rottal-Inn.",

    order_h2: "Order",
    order_cap: "Send a web order via email — we usually respond the same day.",
    order_web_title: "Web order (email)",
    order_web_desc: "This form opens your email app and addresses the request to <strong>kingtech@gmail.com</strong>.",
    form_name: "Your name",
    form_email: "Email",
    form_service: "Service",
    form_message: "Describe your request",
    form_send: "Send",

    contact_h2: "Contact",
    direct: "Direct",
    location: "Location: Eggenfelden, DE · Remote worldwide",
    faq: "FAQ",
    q_nofee: "No fix — no fee?",
    a_nofee: "Possible for data recovery. For IT support you only pay if the problem is solved or you’re satisfied.",
    q_onsite: "On-site appointments?",
    a_onsite: "In the Rottal-Inn district by arrangement. Travel fee possible.",
    q_pay: "Payment methods?",
    a_pay: "Cash or PayPal. Invoice for cash payments via Zervant. More options coming soon.",

    privacy_h2: "Privacy (short)",
    privacy_p1: "We process personal data (e.g. name, email) only to answer inquiries and orders (Art. 6(1)(b,f) GDPR).",
    privacy_p2: "When using WhatsApp, their privacy policy applies. Data may be transferred to third countries.",
    privacy_p3: "Rights: access, rectification, deletion, restriction. Contact: kingtech@gmail.com",
    privacy_link: "Privacy",
  }
};

document.addEventListener('DOMContentLoaded', () => {
  const yr = document.getElementById('yr');
  if (yr) yr.textContent = new Date().getFullYear();

  const routes = ['','services','pricing','about','order','contact','impressum','privacy','agb'];
  function show(page) {
    document.querySelectorAll('.page').forEach(sec => sec.hidden = true);
    const target = page || 'home';
    const el = document.querySelector(`[data-page="${target}"]`);
    (el || document.querySelector('[data-page="home"]')).hidden = false;

    document.querySelectorAll('[data-route]').forEach(a => {
      const want = a.getAttribute('href');
      a.classList.toggle('primary', want === `#/${target === 'home' ? '' : target}`);
    });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
  function parseRoute(){
    const hash = location.hash.replace(/^#\//,'');
    const [page, query] = hash.split('?');
    const valid = routes.includes(page) ? (page || 'home') : 'home';
    show(valid);
    if (valid === 'order' && query) {
      const params = new URLSearchParams(query);
      const svc = params.get('svc');
      if (svc) {
        const sel = document.getElementById('orderService');
        if (sel) sel.value = decodeURIComponent(svc);
      }
    }
  }
  window.addEventListener('hashchange', parseRoute);

  const langSel = document.getElementById('lang');
  const savedLang = localStorage.getItem('kingtech_lang');
  const initialLang = (savedLang === 'en') ? 'en' : 'de';
  function applyI18n(lang){
    const dict = I18N[lang] || I18N.de;
    document.querySelectorAll('[data-i18n]').forEach(node => {
      const key = node.getAttribute('data-i18n');
      if (dict[key] !== undefined) {
        if (node.tagName === 'INPUT' || node.tagName === 'TEXTAREA') {
          node.setAttribute('placeholder', dict[key]);
        } else {
          node.innerHTML = dict[key];
        }
      }
    });
    document.querySelectorAll('[data-i18n-placeholder]').forEach(node => {
      const key = node.getAttribute('data-i18n-placeholder');
      if (dict[key] !== undefined) node.setAttribute('placeholder', dict[key]);
    });
    document.querySelectorAll('[data-i18n-label]').forEach(node => {
      const key = node.getAttribute('data-i18n-label');
      if (dict[key] !== undefined) node.setAttribute('aria-label', dict[key]);
    });
    document.documentElement.lang = lang;
    localStorage.setItem('kingtech_lang', lang);
  }
  langSel.value = initialLang;
  langSel.addEventListener('change', () => applyI18n(langSel.value));
  applyI18n(initialLang);

  const servicesGrid = document.getElementById('servicesGrid');
  const services = document.querySelector('#services .grid');
  if (servicesGrid && services){ servicesGrid.innerHTML = services.innerHTML; }

  window.mailtoSubmit = function (e) {
    e.preventDefault();
    const f = new FormData(e.target);
    const svc = f.get('service');
    const subject = encodeURIComponent(`[${svc}] Kundenbestellung von ${f.get('name')}`);
    const body = encodeURIComponent(
`Name: ${f.get('name')}
E-Mail: ${f.get('email')}
Leistung: ${svc}
Nachricht:
${f.get('message') || ''}`
    );
    window.location.href = `mailto:kingtech@gmail.com?subject=${subject}&body=${body}`;
    return false;
  };

  window.copyPayPal = function(){
    const el = document.getElementById('ppEmail');
    if (!el) return;
    const txt = el.textContent.trim();
    navigator.clipboard.writeText(txt).then(()=>{
      const btn = event?.currentTarget;
      if (btn){ btn.textContent = "Kopiert!"; setTimeout(()=>btn.textContent="E-Mail kopieren",1500); }
    });
  };

  parseRoute();
});
